---
contentKey: chapter
title: Attendees Screen
stepNo: 5
metaTitle: Attendees Screen page
metaDescription: Attendees Screen description
date: 2022-01-25T21:11:31.867Z
duration: 30 min
tags:
  - flutter
  - firebase
keywords:
  - flutter
  - firebase
---
# ðŸ§‘â€ðŸ¤â€ðŸ§‘ Attendees Screen

After login we need to redirect to `attendees_screen`,Â 

Create a new ðŸ“„ file under `screens` ðŸ“ folder  => **attendees_screen.dart**

```
import 'package:flutter/material.dart';

import 'package:gdg_flutter_firebase_chat/models/user.dart';

import 'package:gdg_flutter_firebase_chat/models/user_data.dart';

import 'package:gdg_flutter_firebase_chat/services/auth_service.dart';

import 'package:gdg_flutter_firebase_chat/services/database_service.dart';

import 'package:gdg_flutter_firebase_chat/widgets/all_attendees_widget.dart';

import 'package:provider/provider.dart';

Â 

class AttendeesScreen extends StatefulWidget {

Â Â static final String id ='attendees_screen';

Â 

Â @override

Â _AttendeesScreenState createState() => _AttendeesScreenState();

}

Â 

class _AttendeesScreenState extends State<AttendeesScreen> {

Â List<User> _users = \[];

Â @override

Â void initState() {

Â Â Â super.initState();

Â Â Â _setupAttendees();

Â }

Â 

Â _setupAttendees() async {

Â Â Â String currentUserId =Provider.of<UserData>(context, listen: false).currentUserId;

Â Â Â List<User> users = await Provider.of<DataBaseService>(context, listen: false)

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .getAllUsers(currentUserId);

Â Â Â if (mounted) {

Â Â Â Â Â setState(() {

Â Â Â Â Â Â Â _users = users;

Â Â Â Â Â });

Â Â Â }

Â }

Â @override

Â Widget build(BuildContext context) {

Â Â Â 

Â Â Â return Scaffold(

Â Â Â Â Â backgroundColor: Theme.of(context).primaryColor,

Â Â Â Â Â appBar: AppBar(

Â Â Â Â Â Â Â leading: IconButton(

Â Â Â Â Â Â Â Â Â icon: Icon(Icons.menu),

Â Â Â Â Â Â Â Â Â iconSize: 30.0,

Â Â Â Â Â Â Â Â Â color: Colors.white,

Â Â Â Â Â Â Â Â Â onPressed: () {},

Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â title: Text(

Â Â Â Â Â Â Â Â Â 'Attendees',

Â Â Â Â Â Â Â Â Â style: TextStyle(

Â Â Â Â Â Â Â Â Â Â Â fontSize: 28.0,

Â Â Â Â Â Â Â Â Â Â Â fontWeight: FontWeight.bold,

Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â elevation: 0.0,

Â Â Â Â Â Â Â actions: <Widget>[

Â Â Â Â Â Â Â Â Â IconButton(

Â Â Â Â Â Â Â Â Â Â Â icon: Icon(Icons.exit_to_app),

Â Â Â Â Â Â Â Â Â Â Â onPressed: Provider.of<AuthService>(context, listen: false).logout,

Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â ],

Â Â Â Â Â ),

Â Â Â Â Â body: Column(

Â Â Â Â Â Â Â children: <Widget>[

Â Â Â Â Â Â Â Â Â Expanded(

Â Â Â Â Â Â Â Â Â Â Â child: Container(

Â Â Â Â Â Â Â Â Â Â Â Â Â decoration: BoxDecoration(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â color: Theme.of(context).accentColor,

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â borderRadius: BorderRadius.only(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â topLeft: Radius.circular(30.0),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â topRight: Radius.circular(30.0),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â child: Column(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â children: <Widget>[

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â AllAttendees(users:_users),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ],

Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â ],

Â Â Â Â Â ),

Â Â Â );

Â }

}
```

### Model to Store Current User data

To store current user data we will create a model -> user_data.dart under models ðŸ“ folder it extends ChangeNotifierProvider

```
import 'package:flutter/cupertino.dart';

Â 

class UserData extends ChangeNotifier {

Â Â String currentUserId;

}
```

We use to pass data between screens, for that we will use provider package A mixture between dependency injection (DI) and state management, built with widgets for widgets.

> `provider: ^4.0.3`

The attendees are all the users they have registered. We update our database service and create a new function to get all users.

services

ðŸ“„ File => database_service.dart

```
import 'package:cloud_firestore/cloud_firestore.dart';

import 'package:gdg_flutter_firebase_chat/helpers/constants.dart';

import 'package:gdg_flutter_firebase_chat/models/user.dart';

Â 

class DataBaseService {

Â Future<User> getUser(String userId) async {

Â Â Â DocumentSnapshot userDoc = await usersRef.document(userId).get();

Â Â Â return User.fromDoc(userDoc);

Â }

Â 

Â Future<List<User>> getAllUsers(String currentUserId) async {

Â Â Â QuerySnapshot userSnapshot = await usersRef.getDocuments();

Â Â Â List<User> users = \[];

Â Â Â userSnapshot.documents.forEach((doc) {

Â Â Â Â Â User user = User.fromDoc(doc);

Â Â Â Â Â if (user.id != currentUserId) users.add(user);

Â Â Â });

Â Â Â return users;

Â }

}
```

### Introduction to widget - separation of concern

Create a ðŸ“ folder for â€˜widgetsâ€™ => add ðŸ“„ file all_attendees_widget.dart

```
import 'package:flutter/material.dart';

import 'package:gdg_flutter_firebase_chat/models/user.dart';

import 'package:gdg_flutter_firebase_chat/screens/chat_screen.dart';

import 'package:cached_network_image/cached_network_image.dart';

Â 

class AllAttendees extends StatelessWidget {

Â final List<User> users;

Â 

Â const AllAttendees({this.users});

Â @override

Â Widget build(BuildContext context) {

Â Â Â return Expanded(

Â Â Â Â Â child: Container(

Â Â Â Â Â Â Â decoration: BoxDecoration(

Â Â Â Â Â Â Â Â Â color: Colors.white,

Â Â Â Â Â Â Â 

Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â child: Padding(

Â Â Â Â Â Â Â Â Â padding: const EdgeInsets.all(8.0),

Â Â Â Â Â Â Â Â Â child: ListView.builder(

Â Â Â Â Â Â Â Â Â Â Â itemCount: users.length,

Â Â Â Â Â Â Â Â Â Â Â itemBuilder: (BuildContext context, int index) {

Â Â Â Â Â Â Â Â Â Â Â Â Â final User user = users\[index];

Â Â Â Â Â Â Â Â Â Â Â Â Â return GestureDetector(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â onTap: () => Navigator.push(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â context,

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â MaterialPageRoute(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â builder: (_) => ChatScreen(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â // user: chat.sender,

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â child: Container(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â margin: EdgeInsets.only(top: 5.0, bottom: 5.0, right: 5.0),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â padding:

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â EdgeInsets.symmetric(horizontal: 10.0, vertical: 10.0),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â decoration: BoxDecoration(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â color: Color(0xFFFFEFEE),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â borderRadius: BorderRadius.all( Radius.circular(20.0)

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â child: Row(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â mainAxisAlignment: MainAxisAlignment.spaceBetween,

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â children: <Widget>[

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Row(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â children: <Widget>[

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CircleAvatar(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â radius: 35.0,

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â backgroundImage: user.profileImageUrl.isEmpty

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ? AssetImage('assets/images/user_placeholder.jpg')

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â : CachedNetworkImageProvider(user.profileImageUrl),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â SizedBox(width: 10.0),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Column(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â crossAxisAlignment: CrossAxisAlignment.start,

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â children: <Widget>[

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Text(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â user.name,

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â style: TextStyle(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â color: Colors.grey,

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â fontSize: 15.0,

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â fontWeight: FontWeight.bold,

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â SizedBox(height: 5.0),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Text(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â user.bio,

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â style: TextStyle(

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â color: Colors.grey,

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â fontSize: 15.0,

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ],

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ],

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ],

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â Â Â Â Â Â Â );

Â Â Â Â Â Â Â Â Â Â Â },

Â Â Â Â Â Â Â Â Â ),

Â Â Â Â Â Â Â ),

Â Â Â Â Â ),

Â Â Â );

Â }

}
```

### User profile images

Profile images will come from the network, We will use Flutter library to load and cache network images We are using cached_network_image ,add to pubspec.yaml and get the package..

> Â `cached_network_image: ^2.0.0`

We got all our references now we need to navigate from main to attendees screen if we are logged in.

Quickly update login screen and give it an id , will be used for routes

```
class LoginScreen extends StatefulWidget {

Â Â Â static final String id ='login_screen';
```

### Main.dart Refactoring

We will refactor main.dart, and check if the is logged in , wei will create a new class that extends statelessWwidget.

```
class MyApp extends StatelessWidget {

Â Widget _getScreenId() {

Â Â Â return StreamBuilder<FirebaseUser>(

Â Â Â Â Â stream: FirebaseAuth.instance.onAuthStateChanged,

Â Â Â Â Â builder: (BuildContext context, snapshot) {

Â Â Â Â Â Â Â if (snapshot.hasData) {

Â Â Â Â Â Â Â Â Â Provider.of<UserData>(context).currentUserId = snapshot.data.uid;

Â Â Â Â Â Â Â Â Â return AttendeesScreen();

Â Â Â Â Â Â Â } else {

Â Â Â Â Â Â Â Â Â return LoginScreen();

Â Â Â Â Â Â Â }

Â Â Â Â Â },

Â Â Â );

Â }
 Â // This widget is the root of your application.

Â @override

Â Widget build(BuildContext context) {

Â Â Â return MaterialApp(

Â Â Â Â Â title: "GDG Firebase chat",

Â Â Â Â Â debugShowCheckedModeBanner: false,

Â Â Â Â Â theme: ThemeData(

Â Â Â Â Â Â Â primaryColor: AppConstants.hexToColor(AppConstants.APP_PRIMARY_COLOR),

Â Â Â Â Â Â Â backgroundColor:

Â Â Â Â Â Â Â Â Â Â Â AppConstants.hexToColor(AppConstants.APP_BACKGROUND_COLOR),

Â Â Â Â Â Â Â primaryColorLight:

Â Â Â Â Â Â Â Â Â Â Â AppConstants.hexToColor(AppConstants.APP_PRIMARY_COLOR_LIGHT),

Â Â Â Â Â Â Â accentColor: Colors.black,

Â Â Â Â Â Â Â accentIconTheme: IconThemeData(color: Colors.black),

Â Â Â Â Â Â Â dividerColor: Colors.black12,

Â Â Â Â Â Â Â textTheme: TextTheme(

Â Â Â Â Â Â Â Â Â caption: TextStyle(color: Colors.white),

Â Â Â Â Â Â Â ),

Â Â Â Â Â ),

Â Â Â Â Â home: _getScreenId(),

Â Â Â Â Â routes: {

Â Â Â Â Â Â Â LoginScreen.id: (context) => LoginScreen(),

Â Â Â Â Â Â Â AttendeesScreen.id: (context) => AttendeesScreen(),

Â Â Â Â Â },

Â Â Â );

Â }

}
```

Â And modify run app to call MyApp(), I will also define all my providers for app

```
runApp(MultiProvider(providers: [
Â Â Â ChangeNotifierProvider(
Â Â Â Â Â create: (_) => UserData(),
Â Â Â ),

Â Â Â Provider<AuthService>(
Â Â Â Â Â create: (_) => AuthService(),
Â Â Â ),

Â Â Â Provider<DataBaseService>(
Â Â Â Â Â create: (_) => DataBaseService(),
Â Â Â ),

Â ], child: MyApp()));

}
```

We can see the attendees screen with a list of attendees.